jQuery(function(){function o(o){return g.x=o.clientX,g.y=o.clientY,g.matrixTransform(c.getScreenCTM().inverse())}storage=$.localStorage,svgBoard=new componentHightLighter,svgBoard.setKeyframe("blink"),svgBoard.setButtonAnchor("b-"),svgBoard.setLocalStorage(storage),allComponents=[],jQuery.each($("#components").find("g"),function(o,e){allComponents.push(e.id)}),svgBoard.addComponents($("#components").find("g"));var e=$(".step"),t=e.length,n=1;e.slice(n).hide(),$(".pagination-page").pagination({items:t,itemsOnPage:n,displayedPages:5,edges:0,hrefTextPrefix:"#step-",cssStyle:"dark-theme",onPageClick:function(o){var t=n*(o-1),a=t+n;e.hide().slice(t,a).show(),currentComponents=e.slice(t,a)[0].getAttribute("id").split("_"),svgBoard.addComponents(allComponents),svgBoard.addCurrentComponents(currentComponents),svgBoard.draw()}});var a=function(){var o=window.location.hash||"#step-1";o=o.match(/^#step-(\d+)$/),o&&$("#pagination").pagination("selectPage",parseInt(o[1]))};$(window).bind("popstate",a),a();var i=svgPanZoom("#pcb",{panEnabled:!1,zoomEnabled:!0,controlIconsEnabled:!1,mouseWheelZoomEnabled:!1,dblClickZoomEnabled:!1,center:!1,zoomScaleSensitivity:3}),r=i.getSizes().realZoom,s=!1,l=function(o,e){1==s?(i.reset(),s=!1):(i.pan({x:0,y:0}),svgBoard.isFlipped()?(zoom_atx=o*r+i.getSizes().width/2,zoom_aty=-(e*r)+i.getSizes().height/2):(zoom_atx=-(o*r)+i.getSizes().width/2,zoom_aty=-(e*r)+i.getSizes().height/2),i.pan({x:zoom_atx,y:zoom_aty}),i.zoom(3),s=!0)},c=document.querySelector("svg"),g=c.createSVGPoint();c.addEventListener("click",function(e){var t=o(e);l(t.x,t.y)},!1);var d=0,p=function(o){hPoints=[];for(var e=0;e<o.length;e++){var t=[];hx=$("#"+o[e]).children("text:first").attr("x"),hy=$("#"+o[e]).children("text:first").attr("y"),t.push(hx),t.push(hy),hPoints.push(t)}return hPoints},h=function(o,e){s=!0,i.reset(),i.pan({x:0,y:0}),x=o[e][0],y=o[e][1],svgBoard.isFlipped()?(zoom_atx=x*r+i.getSizes().width/2,zoom_aty=-(y*r)+i.getSizes().height/2):(zoom_atx=-(x*r)+i.getSizes().width/2,zoom_aty=-(y*r)+i.getSizes().height/2),i.pan({x:zoom_atx,y:zoom_aty}),i.zoom(3)},m=new window.keypress.Listener;m.simple_combo("space",function(){d=0,s=!1,i.reset(),$(".pagination-page").pagination("nextPage")}),m.simple_combo("b",function(){d=0,s=!1,i.reset(),$(".pagination-page").pagination("prevPage")}),m.simple_combo("esc",function(){s=!1,i.reset()}),m.simple_combo("p",function(){highLightedPoints=p(svgBoard.getCurrentComponents()),h(highLightedPoints,d),d++,d==highLightedPoints.length&&(d=0)}),$("#pref-board-color").colorselector({callback:function(o,e,t){$("#colorValue").val(o),$("#colorColor").val(e),$("#colorTitle").val(t),svgBoard.setPreferencesBoardColor(e)}}),$("#pref-done-color").colorselector({callback:function(o,e,t){$("#colorValue").val(o),$("#colorColor").val(e),$("#colorTitle").val(t),svgBoard.setPreferencesDoneColor(e)}}),$("#pref-todo-color").colorselector({callback:function(o,e,t){$("#colorValue").val(o),$("#colorColor").val(e),$("#colorTitle").val(t),svgBoard.setPreferencesTodoColor(e)}})});